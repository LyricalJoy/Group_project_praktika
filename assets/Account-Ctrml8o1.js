import{_ as b,r as c,b as v,i as m,e as p,d as t,v as g,f as _,t as S,o as O,k,F as $,n as I}from"./index-CEPjqowA.js";const J={class:"form"},V={__name:"LoginForm",emits:["login"],setup(U,{emit:f}){const a=f,e=c(""),n=c("");c("");function i(){a("login",{login:e.value,password:n.value})}return(d,s)=>(m(),v("div",J,[p(t("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>e.value=l),placeholder:"Логин"},null,512),[[g,e.value]]),p(t("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>n.value=l),type:"password",placeholder:"Пароль"},null,512),[[g,n.value]]),t("button",{onClick:i},"Войти")]))}},C=b(V,[["__scopeId","data-v-281ef63c"]]),x={class:"form"},F={key:0,class:"error"},L={__name:"RegisterForm",emits:["register-success","register-error"],setup(U,{emit:f}){const a=f,e=c({login:"",lastName:"",firstName:"",middleName:"",email:"",password:"",confirmPassword:""}),n=c("");function i(){n.value="";const d=JSON.parse(localStorage.getItem("users")||"[]");if(d.find(l=>l.login===e.value.login)){n.value="Пользователь с таким логином уже существует",a("register-error",n.value);return}if(e.value.password!==e.value.confirmPassword){n.value="Пароли не совпадают",a("register-error",n.value);return}const s={login:e.value.login,lastName:e.value.lastName,firstName:e.value.firstName,middleName:e.value.middleName,email:e.value.email,password:e.value.password,role:"user"};d.push(s),localStorage.setItem("users",JSON.stringify(d)),localStorage.setItem("currentUser",JSON.stringify(s)),a("register-success",s)}return(d,s)=>(m(),v("div",x,[p(t("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>e.value.login=l),placeholder:"Логин"},null,512),[[g,e.value.login]]),p(t("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>e.value.lastName=l),placeholder:"Фамилия"},null,512),[[g,e.value.lastName]]),p(t("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>e.value.firstName=l),placeholder:"Имя"},null,512),[[g,e.value.firstName]]),p(t("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>e.value.middleName=l),placeholder:"Отчество"},null,512),[[g,e.value.middleName]]),p(t("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>e.value.email=l),placeholder:"Email"},null,512),[[g,e.value.email]]),p(t("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>e.value.password=l),type:"password",placeholder:"Пароль"},null,512),[[g,e.value.password]]),p(t("input",{"onUpdate:modelValue":s[6]||(s[6]=l=>e.value.confirmPassword=l),type:"password",placeholder:"Повторите пароль"},null,512),[[g,e.value.confirmPassword]]),t("button",{onClick:i},"Зарегистрироваться"),n.value?(m(),v("p",F,S(n.value),1)):_("",!0)]))}},P=b(L,[["__scopeId","data-v-144403c6"]]),q={class:"profile"},R={key:0},A={key:1},E={__name:"UserProfile",props:{user:{type:Object,required:!0}},emits:["logout","submit-application","open-my-requests","open-admin-panel"],setup(U,{emit:f}){const a=f,e=U;function n(){a("logout")}function i(){a("submit-application")}function d(){a("open-my-requests")}function s(){a("open-admin-panel")}return(l,y)=>(m(),v("div",q,[t("h2",null,"Добро пожаловать, "+S(e.user.firstName)+"!",1),t("p",null,"Роль: "+S(e.user.role==="admin"?"Администратор":"Пользователь"),1),t("p",null,"Email: "+S(e.user.email),1),t("p",null,"ФИО: "+S(e.user.lastName)+" "+S(e.user.firstName)+" "+S(e.user.middleName),1),e.user.role==="admin"?(m(),v("div",R,[y[0]||(y[0]=t("h3",null,"Админ-панель",-1)),y[1]||(y[1]=t("p",null,"Здесь доступен дополнительный контент для администратора.",-1)),t("button",{onClick:s},"Панель управления")])):(m(),v("div",A,[t("button",{onClick:i},"Подать заявку"),t("button",{onClick:d},"Мои заявки")])),t("button",{onClick:n},"Выйти")]))}},B=b(E,[["__scopeId","data-v-7401289d"]]),M={class:"account-container"},D={class:"form-toggle-buttons"},j={__name:"Account",emits:["login-success","logout","submit-application","open-admin-panel","open-my-requests"],setup(U,{emit:f}){const a=f,e=c(!1),n=c("login"),i=c(null);O(()=>{const r={login:"admin",password:"adminWSR",role:"admin",name:"Администратор"};let o=JSON.parse(localStorage.getItem("registeredUsers")||"[]");o.some(w=>w.login===r.login)||(o.push(r),localStorage.setItem("registeredUsers",JSON.stringify(o)));const N=localStorage.getItem("currentUser");N&&(i.value=JSON.parse(N),e.value=!0)});function d(r){n.value=r}function s(r){const o=JSON.parse(localStorage.getItem("registeredUsers")||"[]");o.some(N=>N.login===r.login)||(o.push(r),localStorage.setItem("registeredUsers",JSON.stringify(o)),localStorage.setItem("currentUser",JSON.stringify(r)),i.value=r,e.value=!0,a("login-success",r))}function l(r){const u=JSON.parse(localStorage.getItem("registeredUsers")||"[]").find(N=>N.login===r.login&&N.password===r.password);u&&(localStorage.setItem("currentUser",JSON.stringify(u)),i.value=u,e.value=!0,a("login-success",u))}function y(){e.value=!1,i.value=null,n.value="login",localStorage.removeItem("currentUser"),a("logout")}return(r,o)=>(m(),v("div",M,[e.value?(m(),k(B,{key:1,user:i.value,onLogout:y,onSubmitApplication:o[2]||(o[2]=u=>r.$emit("submit-application")),onOpenAdminPanel:o[3]||(o[3]=u=>r.$emit("open-admin-panel")),onOpenMyRequests:o[4]||(o[4]=u=>r.$emit("open-my-requests"))},null,8,["user"])):(m(),v($,{key:0},[o[5]||(o[5]=t("h2",null,"Личный кабинет",-1)),o[6]||(o[6]=t("p",null,"Авторизуйтесь, чтобы получить доступ к личному кабинету!",-1)),t("div",D,[t("button",{class:I({active:n.value==="login"}),onClick:o[0]||(o[0]=u=>d("login"))}," Вход ",2),t("button",{class:I({active:n.value==="register"}),onClick:o[1]||(o[1]=u=>d("register"))}," Регистрация ",2)]),n.value==="login"?(m(),k(C,{key:0,onLogin:l})):_("",!0),n.value==="register"?(m(),k(P,{key:1,onRegisterSuccess:s})):_("",!0)],64))]))}},T=b(j,[["__scopeId","data-v-27852b6b"]]);export{T as default};
