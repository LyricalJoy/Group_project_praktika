import{_ as D,r,o as R,h as F,c as a,b as t,i as v,j as V,l as j,F as p,e as k,f as n,t as i,g as B,p as I,k as S}from"./index-Cq-r5gHk.js";const L={class:"container"},O={class:"filter"},E=["value"],J={key:0,class:"no-requests"},T={key:1,class:"status-columns"},$=["onClick"],q={class:"request-header"},z={class:"timestamp"},A=["src"],G={key:1,class:"rejection-comment"},H=["onClick"],K={key:1,class:"no-requests"},P={key:0,class:"modal-overlay"},Q={__name:"MyRequests",setup(W){const c=r([]),g=r(""),y=r(""),m=r(!1),f=r(null),d=r([]),u=r("Все статусы"),C=["Все статусы","Новая","В работе","Выполнено","Отклонена"];R(()=>{const l=localStorage.getItem("currentUserId"),e=localStorage.getItem("currentUserName");g.value=l||"user_"+Math.random().toString(36).substring(2,10),l||localStorage.setItem("currentUserId",g.value),y.value=e||"Пользователь",e||localStorage.setItem("currentUserName",y.value);const s=localStorage.getItem("requests");s&&(c.value=JSON.parse(s))});const h=F(()=>{var e;const l={Новая:[],"В работе":[],Выполнено:[],Отклонена:[]};for(const s of c.value)s.userId===g.value&&(u.value==="Все статусы"||s.status===u.value)&&((e=l[s.status])==null||e.push(s));return u.value!=="Все статусы"?{[u.value]:l[u.value]}:l});function b(l){f.value=l,m.value=!0}function N(){c.value=c.value.filter(l=>l.id!==f.value),localStorage.setItem("requests",JSON.stringify(c.value)),m.value=!1,f.value=null}function U(){m.value=!1,f.value=null}function M(l){d.value.includes(l)?d.value=d.value.filter(e=>e!==l):d.value.push(l)}function w(l){return l.toLowerCase().replace(/\s/g,"-")}return(l,e)=>(n(),a(p,null,[t("div",L,[e[5]||(e[5]=t("h1",null,"Мои заявки",-1)),t("div",O,[e[2]||(e[2]=t("label",{for:"statusFilter"},"Фильтр по статусу:",-1)),V(t("select",{id:"statusFilter","onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s)},[(n(),a(p,null,k(C,s=>t("option",{key:s,value:s},i(s),9,E)),64))],512),[[j,u.value]])]),Object.values(h.value).every(s=>s.length===0)?(n(),a("div",J," У вас пока нет заявок. ")):(n(),a("div",T,[(n(!0),a(p,null,k(h.value,(s,_)=>(n(),a("div",{class:"status-column",key:_},[t("h2",{class:B(["status-header",w(_)])},i(_),3),s.length>0?(n(!0),a(p,{key:0},k(s,o=>(n(),a("div",{key:o.id,class:"request-card",onClick:x=>M(o.id)},[t("div",q,[t("h3",null,i(o.title),1),t("span",z,i(new Date(o.timestamp).toLocaleString()),1)]),d.value.includes(o.id)?(n(),a("div",{key:0,class:"request-details",onClick:e[1]||(e[1]=I(()=>{},["stop"]))},[t("p",null,[e[3]||(e[3]=t("strong",null,"Категория:",-1)),S(" "+i(o.category),1)]),t("p",null,[e[4]||(e[4]=t("strong",null,"Описание:",-1)),S(" "+i(o.description),1)]),o.imageUrl?(n(),a("img",{key:0,src:o.imageUrl,alt:"Фото",class:"image-preview"},null,8,A)):v("",!0),o.status==="Отклонена"&&o.comment?(n(),a("div",G," ПРИЧИНА ОТКЛОНЕНИЯ: "+i(o.comment),1)):v("",!0),o.status==="Новая"?(n(),a("button",{key:2,onClick:I(x=>b(o.id),["stop"]),class:"delete-button"}," Удалить заявку ",8,H)):v("",!0)])):v("",!0)],8,$))),128)):(n(),a("p",K,"Нет заявок"))]))),128))]))]),m.value?(n(),a("div",P,[t("div",{class:"modal"},[e[6]||(e[6]=t("p",null,"Вы уверены, что хотите удалить заявку?",-1)),t("div",{class:"modal-actions"},[t("button",{onClick:N,class:"confirm-button"},"Да, удалить"),t("button",{onClick:U,class:"cancel-button"},"Отмена")])])])):v("",!0)],64))}},Y=D(Q,[["__scopeId","data-v-5ea1fdb9"]]);export{Y as default};
