import{_ as U,r as v,c as f,f as m,b as e,j as p,v as g,p as V,i as $,k as w,m as x,t as S,o as J,q as k,F as C,g as I}from"./index-DEzk2q1T.js";const P={class:"form"},q={__name:"LoginForm",emits:["login"],setup(y,{emit:N}){const a=N,o=v(""),n=v("");v("");function u(){a("login",{login:o.value,password:n.value})}return(b,r)=>(m(),f("div",P,[r[5]||(r[5]=e("h2",null,"Вход",-1)),e("form",{onSubmit:V(u,["prevent"])},[r[2]||(r[2]=e("label",{for:"login"},"Логин",-1)),p(e("input",{id:"login","onUpdate:modelValue":r[0]||(r[0]=s=>o.value=s),placeholder:"Введите логин"},null,512),[[g,o.value]]),r[3]||(r[3]=e("label",{for:"password"},"Пароль",-1)),p(e("input",{id:"password","onUpdate:modelValue":r[1]||(r[1]=s=>n.value=s),type:"password",placeholder:"Введите пароль"},null,512),[[g,n.value]]),r[4]||(r[4]=e("button",{type:"submit"},"Войти",-1))],32)]))}},F=U(q,[["__scopeId","data-v-f2e80fe6"]]),L={class:"form"},R={class:"form-group"},A={class:"form-group"},M={class:"form-group"},E={class:"form-group"},B={class:"form-group"},j={class:"form-group"},D={class:"form-group"},T={class:"agreement"},z=["disabled"],W={key:0,class:"error"},G={__name:"RegisterForm",emits:["register-success","register-error"],setup(y,{emit:N}){const a=N,o=v({login:"",lastName:"",firstName:"",middleName:"",email:"",password:"",confirmPassword:""}),n=v(""),u=v(!1);function b(){n.value="";const r=JSON.parse(localStorage.getItem("users")||"[]");if(!u.value){n.value="Вы должны согласиться на обработку персональных данных",a("register-error",n.value);return}if(r.find(l=>l.login===o.value.login)){n.value="Пользователь с таким логином уже существует",a("register-error",n.value);return}if(o.value.password!==o.value.confirmPassword){n.value="Пароли не совпадают",a("register-error",n.value);return}const s={login:o.value.login,lastName:o.value.lastName,firstName:o.value.firstName,middleName:o.value.middleName,email:o.value.email,password:o.value.password,role:"user"};r.push(s),localStorage.setItem("users",JSON.stringify(r)),localStorage.setItem("currentUser",JSON.stringify(s)),a("register-success",s)}return(r,s)=>(m(),f("div",L,[s[16]||(s[16]=e("h2",null,"Регистрация",-1)),e("div",R,[s[8]||(s[8]=e("label",{for:"login"},"Логин",-1)),p(e("input",{id:"login","onUpdate:modelValue":s[0]||(s[0]=l=>o.value.login=l),placeholder:"Введите логин"},null,512),[[g,o.value.login]])]),e("div",A,[s[9]||(s[9]=e("label",{for:"lastName"},"Фамилия",-1)),p(e("input",{id:"lastName","onUpdate:modelValue":s[1]||(s[1]=l=>o.value.lastName=l),placeholder:"Иванова"},null,512),[[g,o.value.lastName]])]),e("div",M,[s[10]||(s[10]=e("label",{for:"firstName"},"Имя",-1)),p(e("input",{id:"firstName","onUpdate:modelValue":s[2]||(s[2]=l=>o.value.firstName=l),placeholder:"Иван"},null,512),[[g,o.value.firstName]])]),e("div",E,[s[11]||(s[11]=e("label",{for:"middleName"},"Отчество",-1)),p(e("input",{id:"middleName","onUpdate:modelValue":s[3]||(s[3]=l=>o.value.middleName=l),placeholder:"Иванович"},null,512),[[g,o.value.middleName]])]),e("div",B,[s[12]||(s[12]=e("label",{for:"email"},"Email",-1)),p(e("input",{id:"email","onUpdate:modelValue":s[4]||(s[4]=l=>o.value.email=l),placeholder:"ivanov@email.ru"},null,512),[[g,o.value.email]])]),e("div",j,[s[13]||(s[13]=e("label",{for:"password"},"Пароль",-1)),p(e("input",{id:"password","onUpdate:modelValue":s[5]||(s[5]=l=>o.value.password=l),type:"password",placeholder:"Введите пароль"},null,512),[[g,o.value.password]])]),e("div",D,[s[14]||(s[14]=e("label",{for:"confirmPassword"},"Повторите пароль",-1)),p(e("input",{id:"confirmPassword","onUpdate:modelValue":s[6]||(s[6]=l=>o.value.confirmPassword=l),type:"password",placeholder:"Повторите пароль"},null,512),[[g,o.value.confirmPassword]])]),e("label",T,[p(e("input",{type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=l=>u.value=l)},null,512),[[x,u.value]]),s[15]||(s[15]=w(" Я согласен на обработку персональных данных "))]),e("button",{disabled:!u.value,onClick:b},"Зарегистрироваться",8,z),n.value?(m(),f("p",W,S(n.value),1)):$("",!0)]))}},H=U(G,[["__scopeId","data-v-2334f1ec"]]),K={class:"profile"},Q={key:0,class:"admin-section"},X={key:1,class:"user-section"},Y={__name:"UserProfile",props:{user:{type:Object,required:!0}},emits:["logout","submit-application","open-my-requests","open-admin-panel"],setup(y,{emit:N}){const a=N,o=y;function n(){a("logout")}function u(){a("submit-application")}function b(){a("open-my-requests")}function r(){a("open-admin-panel")}return(s,l)=>(m(),f("div",K,[e("h2",null,"Добро пожаловать, "+S(o.user.firstName)+"!",1),e("p",null,[l[0]||(l[0]=e("strong",null,"Роль:",-1)),w(" "+S(o.user.role==="admin"?"Администратор":"Пользователь"),1)]),e("p",null,[l[1]||(l[1]=e("strong",null,"Email:",-1)),w(" "+S(o.user.email),1)]),e("p",null,[l[2]||(l[2]=e("strong",null,"ФИО:",-1)),w(" "+S(o.user.lastName)+" "+S(o.user.firstName)+" "+S(o.user.middleName),1)]),l[5]||(l[5]=e("p",null,"Теперь вы можете подать заявку на улудшение города, а так же просмотреть статус уже поданных вами заявок:",-1)),o.user.role==="admin"?(m(),f("div",Q,[l[3]||(l[3]=e("h3",null,"Админ-панель",-1)),l[4]||(l[4]=e("p",null,"Здесь доступен дополнительный контент для администратора.",-1)),e("button",{onClick:r},"Панель управления")])):(m(),f("div",X,[e("button",{onClick:u},"Подать заявку"),e("button",{onClick:b},"Мои заявки")])),e("button",{class:"logout-button",onClick:n},"Выйти")]))}},Z=U(Y,[["__scopeId","data-v-7cb6d5a4"]]),_={class:"account-container"},h={class:"win"},ee={class:"form-toggle-buttons"},se={__name:"Account",emits:["login-success","logout","submit-application","open-admin-panel","open-my-requests"],setup(y,{emit:N}){const a=N,o=v(!1),n=v("login"),u=v(null);J(()=>{const i={login:"admin",password:"adminWSR",role:"admin",name:"Администратор"};let t=JSON.parse(localStorage.getItem("registeredUsers")||"[]");t.some(O=>O.login===i.login)||(t.push(i),localStorage.setItem("registeredUsers",JSON.stringify(t)));const c=localStorage.getItem("currentUser");c&&(u.value=JSON.parse(c),o.value=!0)});function b(i){n.value=i}function r(i){const t=JSON.parse(localStorage.getItem("registeredUsers")||"[]");t.some(c=>c.login===i.login)||(t.push(i),localStorage.setItem("registeredUsers",JSON.stringify(t)),localStorage.setItem("currentUser",JSON.stringify(i)),u.value=i,o.value=!0,a("login-success",i))}function s(i){const d=JSON.parse(localStorage.getItem("registeredUsers")||"[]").find(c=>c.login===i.login&&c.password===i.password);d&&(localStorage.setItem("currentUser",JSON.stringify(d)),u.value=d,o.value=!0,a("login-success",d))}function l(){o.value=!1,u.value=null,n.value="login",localStorage.removeItem("currentUser"),a("logout")}return(i,t)=>(m(),f("div",_,[o.value?(m(),k(Z,{key:1,user:u.value,onLogout:l,onSubmitApplication:t[2]||(t[2]=d=>i.$emit("submit-application")),onOpenAdminPanel:t[3]||(t[3]=d=>i.$emit("open-admin-panel")),onOpenMyRequests:t[4]||(t[4]=d=>i.$emit("open-my-requests"))},null,8,["user"])):(m(),f(C,{key:0},[t[7]||(t[7]=e("div",{class:"soob"},[e("p",null,"Внимание! Чтобы подать заявку, необходимо зарегистрироваться/авторизоваться.")],-1)),e("div",h,[t[5]||(t[5]=e("h2",null,"Личный кабинет",-1)),t[6]||(t[6]=e("p",{class:"subtitle"},"Авторизуйтесь, чтобы получить доступ к личному кабинету!",-1)),e("div",ee,[e("button",{class:I({active:n.value==="login"}),onClick:t[0]||(t[0]=d=>b("login"))}," Вход ",2),e("button",{class:I({active:n.value==="register"}),onClick:t[1]||(t[1]=d=>b("register"))}," Регистрация ",2)])]),n.value==="login"?(m(),k(F,{key:0,onLogin:s})):$("",!0),n.value==="register"?(m(),k(H,{key:1,onRegisterSuccess:r})):$("",!0)],64))]))}},le=U(se,[["__scopeId","data-v-02d88f6f"]]);export{le as default};
